!function(){"use strict";function t(t,...e){return String.raw({raw:t},...e)}class e extends HTMLElement{static define(t,e={}){return customElements.define(t,this,e),this}static get observedAttributes(){return this.props||[]}constructor(t={}){super(),this._state={},this._props={},this.attachShadow({mode:"open"}),Object.entries(t).forEach((([t,e])=>{this._props[t]=e}));const e=this.initState();e&&"object"==typeof e&&(this._state=e)}initState(){return{}}get state(){return{...this._state}}setState(t){this._state={...this._state,...t}}get props(){return{...this._props}}connectedCallback(){this.syncAttributesToProps(),this._render(),this._afterRender(),this.handleEvent&&n.subscribeToAll(this)}syncAttributesToProps(){(this.constructor.observedAttributes||[]).forEach((t=>{this.hasAttribute(t)&&(this._props[t]=this.getAttribute(t))}))}attributeChangedCallback(t,e,n){e!==n&&(this._props[t]=n,this._render())}adaptCallback(){this._render()}cleanup(){}$(t){return this.shadowRoot.querySelector(t)}$$(t){return this.shadowRoot.querySelectorAll(t)}listen(t,e,n){const s="string"==typeof t?this.$(t):t;s&&s.addEventListener(e,n.bind(this))}_afterRender(){this.setupListeners()}setupListeners(){}template(){return""}_render(){this.shadowRoot.innerHTML="";const t=document.createElement("template");t.innerHTML=`\n<style>\n* {\n  margin: 0;\n  padding: 0;\n  box-sizing: border-box;\n  font-family: var(--font-family, inherit), system-ui;\n}\nimg {\n  max-width: 100%;\n  max-height: 100%;\n  display: block;\n}\nsvg { display: block; }\nbutton {\n  border: none;\n  outline: none;\n  background-color: transparent;\n  cursor: pointer;\n}\n</style> ${this.template()}`,this.shadowRoot.appendChild(t.content.cloneNode(!0))}}class n{static events={};static subscribers=new Map;static subscribeToEvent(t,e){n.events[t]||(n.events[t]=[]),n.events[t].push(e),n.subscribers.has(e)||n.subscribers.set(e,new Set),n.subscribers.get(e).add(t)}static subscribeToAll(t){const e=t.constructor.events;e&&Array.isArray(e)&&e.forEach((e=>{n.subscribeToEvent(e,t)}))}static unsubscribeFromEvent(t,e){n.events[t]&&(n.events[t]=n.events[t].filter((t=>t!==e)),n.subscribers.has(e)&&(n.subscribers.get(e).delete(t),0===n.subscribers.get(e).size&&n.subscribers.delete(e)))}static unsubscribeAll(t){if(n.subscribers.has(t)){[...n.subscribers.get(t)].forEach((e=>{n.unsubscribeFromEvent(e,t)})),n.subscribers.delete(t)}}static triggerEvent(t,e){n.events[t]&&n.events[t].forEach((n=>{"function"==typeof n.handleEvent&&n.handleEvent(t,e)}))}}class s{static async request(t,e={}){try{const n=await fetch(t,e);if(!n.ok)throw new Error(`HTTP error: ${n.status}`);return await n.json()}catch(t){throw console.error("HTTP request failed",t),t}}static get(t,e={}){return s.request(t,{...e,method:"GET"})}static post(t,e,n={}){return s.request(t,{...n,method:"POST",headers:{"Content-Type":"application/json",...n.headers},body:JSON.stringify(e)})}}var i=new class{#t={bot_name:"Bob",customer_name:null,maximized:!1,theme:"light",position:"bottom-right",colors:{primary:"#2e34e0",textColor:"#fff",userMessageBackground:"#fff",botMessageBackground:"#eee",borderColor:"#ddd",error:"#f44336",success:"#66bb6a"},animations:!0,window:{dimensions:{width:420,height:620}},button:{dimensions:{width:48,height:48}},text:{title:"Title Text",subtitle:"sub-title",placeholder:"Ask me anything?",initialMessage:"Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum."},logo_url:"https://www.luccid.ai/wp-content/uploads/2024/10/Flaticon-no-background-Logo-Luccid-Software-big-white-background.png",font_url:"https://fonts.googleapis.com/css2?family=Nunito:ital,wght@0,200..1000;1,200..1000&display=swap",roles:[{buttonLabel:"Support",initialMessage:"Support role initial message"},{buttonLabel:"Tech",initialMessage:"Tech role initial message"}],serverUrl:"http://35.223.127.73:8000",endpoints:{feedback:"http://35.223.127.73:8000/feedback",askQuestion:"http://35.223.127.73:8000/process",files:"http://35.223.127.73:8000/files"},credentials:{client_id:"megasrbin1",password:"megasrbin333",company_id:"isoplussystemde"},files:{supported:["jpg","pdf"]}};#e={...this.#t};constructor(){this.initialized=!1}async init(){try{const t=await fetch("./config_example.json"),e=await t.json();this.#e={...this.#e,...e}}catch(t){console.error("Failed to load remote config, using defaults: ",t),this.#e={...this.#t}}finally{this.initialized=!0}}get credentials(){return this.config.credentials}get config(){return this.initialized?this.#e:(console.warn("Config not initialized yet, call init() first."),null)}};(class extends e{static events=["window-state"];initState(){return{isOpen:!1,config:i.config}}handleEvent(t,e){"window-state"===t&&this.setState({isOpen:e})}setupListeners(){this.listen(this,"click",(t=>{this.setState({isOpen:!this.state.isOpen}),n.triggerEvent("window-state",this.state.isOpen),this.state.config.animations&&this.$("button").animate({transform:["scale(0.95)","scale(1.2)","scale(0.9)","scale(1)"]},{duration:1e3,easing:"cubic-bezier(0.34, 1.56, 0.64, 1)"})})),this.state.config.animations?this.listen(this.$("img"),"load",(()=>this.$("button").style.animation="spin 500ms ease forwards")):(this.$("button").style.opacity=1,this.$("button").style.transform="rotateY(0deg)")}template(){return t(`\n      <style>\n        :host {\n          margin-left: auto;\n          width: var(--button-width);\n          height: var(--button-height);\n          display: block;\n          z-index: 999;\n\n          @media(max-width: 480px) {\n            z-index: 0;\n          }\n\n          .chat-btn {\n            filter: drop-shadow(0 0 1px white);\n\n            svg * {\n              fill: tomato;\n            }\n          }\n        }\n        @keyframes spin {\n          from {\n            opacity: 0;\n            transform: rotateY(180deg);\n          }\n          to {\n            opacity: 1;\n            transform: rotateY(0);\n          }\n        }\n      </style>\n      <button class="chat-btn">\n        <img src="${this.state.config.logo_url}" />\n      </button>\n    `)}}).define("chat-button");class o{constructor(t,e){this.config=t,this.conversation_id=e,this.credentials=this.config.credentials}async sendMessage(t,e){return s.post(this.config.endpoints.askQuestion,{query:t,conversation_id:this.conversation_id,client_id:this.credentials.client_id,password:this.credentials.password,company_id:this.credentials.company_id,chosen_role:""})}async sendfiles(t){return s.post(this.config.endpoints.files,t)}async sendFeedback(t){return s.post(this.config.endpoints.feedback,t)}}class a{constructor(){this.keys={conversationId:"conversation_id",currentRole:"currentRole",messages:"messages"}}get(t){const e=localStorage.getItem(this.keys[t]);return e?JSON.parse(e):null}set(t,e){localStorage.setItem(this.keys[t],JSON.stringify(e))}clear(...t){0===t.length?localStorage.clear():t.forEach((t=>localStorage.removeItem(this.keys[t])))}saveConversation(t,e,n){const s=n.filter((t=>!t.isSystem&&"Loading ..."!==t.content));this.set("conversationId",t),this.set("currentRole",e),this.set("messages",s)}loadConversation(){return{conversationId:this.get("conversationId"),currentRole:this.get("currentRole"),messages:this.get("messages")||[]}}}(class extends e{static props=["user-message-id"];constructor(){super(),this.storage=new a,this.stored=this.storage.loadConversation()}setupListeners(){this.listen(this.$("#negative"),"click",(()=>this.handleFeedback("negative"))),this.listen(this.$("#positive"),"click",(()=>this.handleFeedback("positive")))}handleFeedback(t){"negative"===t&&n.triggerEvent("feedback-popup",!0),n.triggerEvent("feedback-submitted",{messageId:this.props["user-message-id"],type:t})}template(){return t('\n      <style>\n        :host {\n          position: absolute;\n          bottom: 0px;\n          right: -12px;\n\n          z-index: 9999;\n\n          .feedback-container {\n            display: flex;\n            gap: 0.125rem;\n            border: 1px solid #eee;\n            border-radius: 0.5rem;\n            padding: 0.25rem;\n            background-color: white;\n\n            button {\n              border: 1px solid transparent;\n              transition: all 500ms ease;\n              padding-block: 0.125rem;\n              padding-inline: 0.25rem;\n              display: grid;\n              place-items: center;\n              border-radius: 4px;\n\n              &:hover {\n                background-color: #eee;\n                border-color: var(--colors-border-color);\n              }\n            }\n          }\n        }\n      </style>\n      <div class="feedback-container">\n        <button id="positive">\n          <svg\n            xmlns="http://www.w3.org/2000/svg"\n            width="14"\n            height="14"\n            viewBox="0 0 24 24"\n            fill="none"\n            stroke="currentColor"\n            stroke-width="2"\n            stroke-linecap="round"\n            stroke-linejoin="round"\n            class="lucide lucide-thumbs-up">\n            <path d="M7 10v12" />\n            <path\n              d="M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z" />\n          </svg>\n        </button>\n        <button id="negative">\n          <svg\n            xmlns="http://www.w3.org/2000/svg"\n            width="14"\n            height="14"\n            viewBox="0 0 24 24"\n            fill="none"\n            stroke="currentColor"\n            stroke-width="2"\n            stroke-linecap="round"\n            stroke-linejoin="round"\n            class="lucide lucide-thumbs-down">\n            <path d="M17 14V2" />\n            <path\n              d="M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z" />\n          </svg>\n        </button>\n      </div>\n    ')}}).define("chat-feedback");(class extends e{static props=["content","message-id","sender","is-system","timestamp","feedback-enabled","user-message-id","from-storage"];initState(){return{config:i.config,typingSpeed:30,isLoading:!1}}attributeChangedCallback(){super.attributeChangedCallback(),setTimeout((()=>{this.setupContent()}),0)}setupContent(){this.state.config.animations&&(this.style.animation="rise 500ms ease forwards");const t=this.$("#content-container");if(!t)return;const e=this.props.content,n=this.props.timestamp||Date.now(),s="true"===this.props["feedback-enabled"],i="bot"===this.props.sender,o="true"===this.props["is-system"],a="true"===this.props["from-storage"];if(i&&"Loading ..."===e)return this.setState({isLoading:!0}),this.classList.add("loading"),void(t.innerHTML=`<div class="loading-animation"> <img src="${this.state.config.logo_url}" /></div>`);const r=this.formatContentWithLinks(e);i&&(s||o)?o&&i?t.innerHTML=`<div class="content">${r}</div>`:(t.innerHTML=`\n    <div class="content"></div>\n    <div class="timestamp">\n      <chat-feedback user-message-id=${this.props["user-message-id"]} style="display: none"></chat-feedback>\n    </div>`,this.state.config.animations&&!a?this.animateText(r,this.$(".content")):(this.$(".content").innerHTML=r,this.$(".timestamp chat-feedback").setAttribute("style",""))):t.innerHTML=`\n      <div class="content">${r}</div>\n      <div class="timestamp">\n        ${this.formatTimestamp(n)}\n      </div>`}animateText(t,e){const s=t.split(" ");let i=0,o="";const a=()=>{if(i<s.length){o+=(i>0?" ":"")+s[i],e.innerHTML=o,i++;const t=20*Math.random()-10,r=this.state.typingSpeed+t;n.triggerEvent("content-updated"),setTimeout(a,r*(s[i-1].length/3+1))}else this.$(".timestamp chat-feedback").setAttribute("style",""),n.triggerEvent("answered")};a()}formatContentWithLinks(t){return t.replace(/(https?:\/\/[^\s]+)/g,(t=>`<a href="${t}" target="_blank">${t}</a>`))}formatTimestamp(t){return new Intl.DateTimeFormat("default",{hour12:!1,hour:"2-digit",minute:"2-digit"}).format(t)}template(){return t('\n      <style>\n        :host {\n          display: block;\n          max-width: 100%;\n          word-wrap: break-word;\n          position: relative;\n        }\n        :host([sender="user"]) {\n          padding: 10px !important;\n          border: 1px solid var(--colors-border-color);\n          border-radius: 10px;\n          background-color: var(--colors-user-message-background);\n          margin-left: auto !important;\n          width: max-content;\n          border-bottom-right-radius: 0;\n          scale: 0.95;\n          transform: translateY(20px);\n          .timestamp {\n            margin-left: auto !important;\n            width: max-content;\n          }\n        }\n        @keyframes rise {\n          to {\n            transform: translateY(0);\n            scale: 1;\n          }\n        }\n        :host([sender="bot"]) {\n          padding: 10px !important;\n          border: 1px solid var(--colors-border-color);\n          border-radius: 10px;\n          background-color: var(--colors-bot-message-background);\n          margin-right: auto !important;\n          width: max-content;\n          border-bottom-left-radius: 0;\n          scale: 0.95;\n          transform: translateY(20px);\n\n          chat-feedback {\n            display: none;\n          }\n        }\n        :host([sender="bot"]:hover) {\n          chat-feedback {\n            display: block;\n          }\n        }\n        :host([sender="bot"]:last-child) {\n          chat-feedback {\n            display: block;\n          }\n        }\n        .timestamp {\n          font-size: 12px;\n          color: #757575;\n          position: absolute;\n          bottom: -20px;\n          right: 0;\n        }\n        @keyframes blinkCursor {\n          0%, 100% { border-right-color: transparent; }\n          50% { border-right-color: #555; }\n        }\n        .content.typing::after {\n          content: "";\n          display: inline-block;\n          width: 2px;\n          height: 1em;\n          background: #555;\n          margin-left: 2px;\n          vertical-align: text-bottom;\n          animation: blinkCursor 0.8s infinite;\n        }\n\n        .loading-animation {\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          animation: pulse 1.5s ease-in-out infinite;\n\n          img {\n            width: 36px;\n            height: 36px;\n          }\n        }\n        @keyframes pulse {\n          0%, 100% {\n            transform: scale(1);\n          }\n          50% {\n            transform: scale(1.1);\n          }\n        }\n        :host(.loading) {\n          border: none;\n          background-color: transparent;\n        }\n      </style>\n      <div\n        id="content-container"\n        class="content-container">\n      </div>\n      <slot name="extra-content"></slot>\n    ')}}).define("chat-message");(class extends e{static events=["answerd"];initState(){return{config:i.config,shiftPressed:!1,message:""}}setupListeners(){this.input=this.$("#message-input"),this.inputBtn=this.$("#file-upload-btn"),this.sendBtn=this.$("#send-button"),this.actions=this.$(".actions"),this.kbdStatus=this.$("#kbd-status"),this.autogrowDiv=this.$(".autogrow"),this.listen(this,"keydown",(t=>"Shift"===t.key?this.setState({shiftPressed:!0}):null)),this.listen(this,"keyup",(t=>"Shift"===t.key?this.setState({shiftPressed:!1}):null)),this.listen(this.input,"input",this.handleInput.bind(this)),this.listen(this.sendBtn,"click",this.handleInput.bind(this)),this.listen(this.inputBtn,"click",(()=>n.triggerEvent("open-file-upload"))),this.autogrowDiv.setAttribute("data-replicated-value","")}handleEvent(t,e){"answerd"===t&&(this.input.disabled=!1)}handleInput(t){this.setState({message:this.input.value}),"insertLineBreak"!==t.inputType&&"click"!==t.type||this.state.shiftPressed?this.autogrowDiv.setAttribute("data-replicated-value",this.input.value):(n.triggerEvent("message-sent",{message:this.state.message.replace(/\n/g,"")}),this.input.value="",this.setState({message:""}),this.input.disabled=!0,this.autogrowDiv.setAttribute("data-replicated-value","")),this.toggleActionVisibility(),this.kbdStatus.classList.toggle("show",this.state.message.length>=6)}toggleActionVisibility(){this.state.message?this.actions.classList.add("show"):this.actions.classList.remove("show")}template(){return t(`\n      <style>\n        :host {\n          flex: 1;\n\n          div {\n            display: flex;\n            align-items: center;\n            overflow: hidden;\n          }\n\n          .autogrow {\n            display: grid;\n            grid-template-columns: 1fr auto;\n            width: 100%;\n            max-width: 100%;\n            overflow-wrap: break-word;\n\n            &::after {\n              content: attr(data-replicated-value) " ";\n              white-space: pre-wrap;\n              visibility: hidden;\n              overflow-wrap: break-word;\n              word-break: break-all;\n              overflow: hidden;\n              height: auto;\n              min-height: 24px;\n              max-height: 400px;\n              font: inherit;\n              padding: 0;\n            }\n\n            & > textarea,\n            &::after {\n              grid-area: 1 / 1 / 2 / 2;\n              font: inherit;\n              width: 100%;\n            }\n          }\n\n          textarea {\n            width: 100%;\n            height: 100%;\n            border: none;\n            outline: none;\n            resize: none;\n            overflow: hidden;\n            white-space: pre-wrap;\n            overflow-wrap: break-word;\n            word-break: break-all;\n            padding: 0;\n            font: inherit;\n            min-height: 24px;\n          }\n\n          .actions {\n            margin-bottom: auto;\n            transform: translateX(50%);\n            transition: all 500ms ease;\n\n            label,\n            button {\n              width: 32px;\n              height: 32px;\n              border-radius: 8px;\n\n              display: grid;\n              place-items: center;\n\n              border: 1px solid transparent;\n              transition: all 500ms ease;\n\n              &:hover {\n                background-color: #eee;\n                background-color: var(--colors-primary);\n                color: var(--colors-text-color);\n                border: 1px solid var(--colors-border-color);\n                cursor: pointer;\n              }\n            }\n\n            button#send-btn {\n              filter: blur(5px);\n              opacity: 0;\n            }\n\n            &.show {\n              transform: translateX(0);\n\n              button#send-btn {\n                filter: blur(0px);\n                opacity: 1;\n                margin-left: 6px;\n              }\n            }\n          }\n\n          p {\n            text-align: right;\n            font-size: 12px;\n            margin-top: -16.5px;\n            transition: all 500ms ease;\n            position: relative;\n            z-index: -1;\n            opacity: 0;\n\n            kbd {\n              padding: 0 10px;\n              background-color: #eee;\n              border-radius: 4px;\n              font-weight: 600;\n            }\n\n            &.show {\n              margin-top: 5px;\n              z-index: 0;\n              opacity: 1;\n            }\n          }\n        }\n      </style>\n      <div class="autogrow" data-replicated-value="">\n        <textarea\n          rows="1"\n          id="message-input"\n          placeholder="${this.state.config.text.placeholder}"\n          autofocus></textarea>\n        <div class="actions">\n          <button id="file-upload-btn">\n            <svg\n              xmlns="http://www.w3.org/2000/svg"\n              width="18"\n              height="18"\n              viewBox="0 0 24 24"\n              fill="none"\n              stroke="currentColor"\n              stroke-width="2"\n              stroke-linecap="round"\n              stroke-linejoin="round"\n              class="lucide lucide-paperclip">\n              <path d="M13.234 20.252 L21 12.3" />\n              <path\n                d="m16 6-8.414 8.586a2 2 0 0 0 0 2.828 2 2 0 0 0 2.828 0l8.414-8.586a4 4 0 0 0 0-5.656 4 4 0 0 0-5.656 0l-8.415 8.585a6 6 0 1 0 8.486 8.486" />\n            </svg>\n          </button>\n          <button\n            id="send-button"\n            title="send">\n            <svg\n              xmlns="http://www.w3.org/2000/svg"\n              width="18"\n              height="18"\n              viewBox="0 0 24 24"\n              fill="none"\n              stroke="currentColor"\n              stroke-width="2"\n              stroke-linecap="round"\n              stroke-linejoin="round"\n              class="lucide lucide-send-horizontal">\n              <path\n                d="M3.714 3.048a.498.498 0 0 0-.683.627l2.843 7.627a2 2 0 0 1 0 1.396l-2.842 7.627a.498.498 0 0 0 .682.627l18-8.5a.5.5 0 0 0 0-.904z" />\n              <path d="M6 12h16" />\n            </svg>\n          </button>\n        </div>\n      </div>\n      <p id="kbd-status">Use <kbd>shift + return</kbd> for new line</p>\n    `)}}).define("message-input");(class extends e{static events=["feedback-popup"];setupListeners(){this.listen("#close-btn","click",(()=>n.triggerEvent("feedback-popup",!1))),this.listen("#submit-btn","click",this.handleSubmitFeedback)}handleSubmitFeedback(){const t=this.$("input").value;n.triggerEvent("feedback-submitted",{feedbackText:t,isFromPopup:!0}),n.triggerEvent("feedback-popup",!1),this.$("input").value=""}handleEvent(t,e){"feedback-popup"===t&&e&&requestAnimationFrame((()=>this.$("input")?.focus()))}template(){return t`<style>:host{width:100%}.fb-container{width:90%;max-width:350px;box-shadow:0 0 3px #ddd;margin:auto;background:#fff;border:1px solid var(--colors-border-color);border-radius:10px;display:grid;padding:20px;gap:1rem}input{padding:5px;border-radius:6px;border:1px solid var(--colors-border-color);font-size:14px;outline:0;width:100%;margin-top:12px}.fb-actions{display:flex;gap:12px;justify-content:flex-end}.fb-actions button{padding:4px 8px;border:1px solid var(--colors-border-color);font-size:14px;border-radius:6px}.fb-actions .submit-btn{background-color:var(--colors-primary);color:var(--colors-text-color);transition:all 250ms ease}.submit-btn:hover{background-color:var(--colors-primary-hover)}</style><div class="fb-container"><label for="fb-input">Please provide details? <input type="text" id="fb-input" require placeholder="What was unsatisfying about this response?"></label><div class="fb-actions"><button class="close-btn" id="close-btn">Cancel</button> <button class="submit-btn" id="submit-btn">Submit</button></div></div>`}}).define("feedback-popup");(class extends e{static events=["window-state","message-sent","content-updated","feedback-popup","feedback-submitted"];constructor(){super(),this.storage=new a,this.stored=this.storage.loadConversation(),this.conversation_id=this.stored.conversationId||crypto.randomUUID(),this.apiService=new o(i.config,this.conversation_id),this.setState({messages:this.stored.messages||[],currentRole:this.stored.currentRole||null})}initState(){return{config:i.config,messages:[],isMaximized:i.config.maximized||!1,scrolling:!1,roles:i.config.roles||[],currentRole:null,userMessageId:null,isInitialRender:!0}}_afterRender(){super._afterRender(),this.setupWindow(),this.renderInitialMessageWithRoles(),this.state.isMaximized&&(this.updateMaximizeButton(),this.classList.toggle("maximize"))}setupListeners(){this.maximizeBtn=this.$("#maximize"),this.body=this.$("#body"),this.listen(this.maximizeBtn,"click",this.handleMaximization),this.listen(this.$("#new-chat-button"),"click",this.startNewConversation),this.listen(this.$("#mobile-close-btn"),"click",(()=>n.triggerEvent("window-state",!1))),this.setupRoleListeners()}startNewConversation(){this.conversation_id=crypto.randomUUID(),this.apiService=new o(i.config,this.conversation_id),this.setState({messages:[],currentRole:null}),this.storage.saveConversation(this.conversation_id,null,[]),this.body&&(this.body.innerHTML=""),this.renderInitialMessageWithRoles(),this.disableChat()}handleMaximization(){this.setState({isMaximized:!this.state.isMaximized}),this.updateMaximizeButton(),this.classList.toggle("maximize")}setupWindow(){const t=this.state.config.position||"bottom-right";this.classList.add(t),this.classList.toggle("animate-enabled",i.config.animations),this.state.currentRole||this.disableChat()}handleEvent(t,e){switch(t){case"window-state":this.updateVisibility(e);break;case"message-sent":this.handleUserMessage(e.message);break;case"content-updated":this.scrollToBottom();break;case"feedback-popup":this.handleFeedbackPopup(e);break;case"feedback-submitted":this.handleFeedback(e)}}_currentFeedbackMessageId=null;handleFeedback(t){if(!t.isFromPopup){this._currentFeedbackMessageId=parseInt(t.messageId);const e=this.state.messages.map((e=>e.userMessageId===parseInt(t.messageId)?{...e,feedback:t.type}:e));return this.setState({messages:e}),this.storage.saveConversation(this.conversation_id,this.state.currentRole,e),void("positive"===t.type&&this.submitFeedback(t.type).then((()=>{this.updateFeedbackUI(t.messageId,t.type),this._currentFeedbackMessageId=null})))}this.submitFeedback("negative",t.feedbackText).then((()=>{this.updateFeedbackUI(this._currentFeedbackMessageId,"negative"),this._currentFeedbackMessageId=null}))}submitFeedback(t,e=""){const n=this.state.messages,s=n.findIndex((t=>t.userMessageId==this._currentFeedbackMessageId&&"bot"===t.sender)),i=s>0?s-1:-1;if(-1===s||-1===i)return void console.error("Could not find messages for feedback");const o=n[i],a=n[s],r={feedback:t,user_question:o.content,ai_answer:a.content,client_id:"megasrbin1",password:"megasrbin333",conv_id:this.conversation_id,feedback_text:e};return this.apiService.sendFeedback(r).then((t=>console.log("Submitting feedback:",r))).catch((t=>console.error("Error submitting feedback:",t)))}updateFeedbackUI(t,e){const n=this.body.querySelector(`[user-message-id="${t}"]`);n&&(n.classList.remove("feedback-positive","feedback-negative"),n.classList.add(`feedback-${e}`))}handleFeedbackPopup(t){this.$("#feedback-popup").classList.toggle("show",t),this.listen("#feedback-popup","click",(t=>{t.target===t.currentTarget&&n.triggerEvent("feedback-popup",!1)}))}handleUserMessage(t){if(!this.state.currentRole)return;if(!t)return;if(!this.body.querySelector('[sender="user"]')){this.body.querySelectorAll('[is-system="true"]').forEach((t=>t.remove())),this.setState({messages:this.state.messages.filter((t=>!t.isSystem))})}this.addMessage(t,"user",!1);const e=this.addMessage("Loading ...","bot",!0);this.apiService.sendMessage(t,this.state.currentRole).then((t=>{t.response&&(e.remove(),this.addMessage(t.response,"bot",!1)),n.triggerEvent("answerd",!0),this.autoFocusTextarea()})).catch((t=>{console.error("Error sending message: ",t),e.remove(),this.addMessage("Sorry there was an error processing your request. Please try again","bot",!0)}))}addMessage(t,e,n=!1){"user"===e&&(this.userMessageId=this.state.messages.length+1);const s={content:t,sender:e,isSystem:n,timestamp:Date.now(),id:this.state.messages.length+1,role:this.state.currentRole};return"bot"===e&&(s.userMessageId=this.userMessageId),this.setState({messages:[...this.state.messages,s],isInitialRender:!1}),this.storage.saveConversation(this.conversation_id,this.state.currentRole,this.state.messages),this.renderMessage(s)}renderMessage(e){if(!e)return;const n=document.createElement("chat-message");if(n.setAttribute("content",e.content),n.setAttribute("message-id",e.id),n.setAttribute("sender",e.sender),n.setAttribute("is-system",e.isSystem),n.setAttribute("timestamp",e.timestamp),this.state.isInitialRender&&n.setAttribute("from-storage","true"),"bot"!==e.sender||e.isSystem||(n.setAttribute("feedback-enabled","true"),n.setAttribute("user-message-id",e.userMessageId),e.feedback&&n.classList.add(`feedback-${e.feedback}`)),e.isSystem&&!this.state.currentRole){const e=document.createElement("div");e.classList.add("role-container"),e.slot="extra-content",e.innerHTML=t`${this.state.roles.map(((t,e)=>`<button class="role-btn" data-label="${t.buttonLabel}" data-index="${e}">${t.buttonLabel}</button>`)).join("")}`,n.appendChild(e)}this.body.appendChild(n),this.scrollToBottom();const s=this.body.querySelectorAll('[sender="bot"]');s.forEach((t=>t.classList.remove("last-bot-message")));const i=s[s.length-1];return i&&i.classList.add("last-bot-message"),n}renderInitialMessageWithRoles(){this.state.currentRole?this.renderMessages():(this.body.innerHTML="",this.addMessage(this.state.config.text.initialMessage,"bot",!0),this.setupRoleListeners())}setupRoleListeners(){this.$$("chat-message .role-btn").forEach((t=>{this.listen(t,"click",(()=>{this.setState({currentRole:t.dataset.label,messages:[]}),this.addMessage(this.state.config.roles[t.dataset.index].initialMessage,"bot",!0),this.storage.saveConversation(this.conversation_id,this.state.currentRole,this.state.messages),this.enableChat(),this.renderMessages()}))}))}scrollToBottom(){this.listen(this.body,"scroll",(()=>{this.setState({scrolling:this.body.scrollTop<this.body.scrollHeight-this.body.clientHeight})})),requestAnimationFrame((()=>{setTimeout((()=>{this.state.scrolling||(this.body.scrollTop=this.body.scrollHeight)}),0)}))}renderMessages(){this.body.innerHTML="",this.renderFeedbackPopup(),this.setState({isInitialRender:!0}),0!==this.state.messages.length&&(this.state.messages.forEach((t=>this.renderMessage(t))),setTimeout((()=>{this.setState({isInitialRender:!1})}),0))}renderFeedbackPopup(){const e=document.createElement("div");e.id="feedback-popup",e.className="feedback-popup",e.innerHTML=t`<feedback-popup></feedback-popup>`,this.body.appendChild(e)}updateMaximizeButton(){this.maximizeBtn.innerHTML=this.state.isMaximized?'\n<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"\n  stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-minimize-2">\n  <polyline points="4 14 10 14 10 20" />\n  <polyline points="20 10 14 10 14 4" />\n  <line x1="14" x2="21" y1="10" y2="3" />\n  <line x1="3" x2="10" y1="21" y2="14" />\n</svg> ':'\n<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"\n  stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"\n  class="lucide lucide-maximize">\n  <path d="M8 3H5a2 2 0 0 0-2 2v3" />\n  <path d="M21 8V5a2 2 0 0 0-2-2h-3" />\n  <path d="M3 16v3a2 2 0 0 0 2 2h3" />\n  <path d="M16 21h3a2 2 0 0 0 2-2v-3" />\n</svg>'}updateVisibility(t){if(this.autoFocusTextarea(),this.scrollToBottom(),t)this.style.display="flex",this.state.config.animations&&this.animate({opacity:[0,1],transform:["bottom-center"===this.state.config.position?["translateY(100px)","translateY(0px)"]:["translateY(50px)","translateY(0)"]].flat(),filter:["blur(10px)","blur(0px)"],scale:[.95,1]},{duration:250});else if(this.animation&&this.animation.cancel(),this.state.config.animations){this.animate({opacity:[1,0],transform:["bottom-center"===this.state.config.position?["translateY(0px)","translateY(100px)"]:["translateY(0px)","translateY(50px)"]].flat(),filter:["blur(0px)","blur(5px)"],scale:[1,.95]},{duration:250}).onfinish=()=>{this.style.display="none"}}else this.style.display="none"}enableChat(){this.$("footer").removeAttribute("disabled"),this.autoFocusTextarea()}autoFocusTextarea(){requestAnimationFrame((()=>this.$("message-input").shadowRoot.querySelector("textarea")?.focus()))}disableChat(){this.$("footer").setAttribute("disabled","true")}template(){return t(`\n      <style>\n        :host {\n          box-sizing: border-box;\n          overflow: hidden;\n          position: fixed;\n          z-index: 1;\n\n          width: var(--window-width);\n          height: var(--window-height);\n\n          flex-direction: column;\n          background-color: white;\n\n          border: 2px solid #000;\n          border-radius: 4px;\n          box-shadow: 3px 3px #000;\n\n          display: none;\n          transition: all 250ms ease;\n\n          @media (max-width: 480px) {\n            inset: 0 !important;\n            width: 100% !important;\n            height: 100% !important;\n\n            .maximize {\n              display: none;\n            }\n          }\n\n          .body {\n            flex: 1;\n            padding-bottom: 100px !important;\n            display: flex;\n            gap: 2rem;\n            flex-direction: column;\n            padding: 1rem;\n            overflow-y: auto;\n          }\n\n          button {\n            transition: scale 250ms ease;\n          }\n        }\n        :host(.maximize) {\n          width: calc(100vw - (88px * 2)) !important;\n          height: calc(100vh - (88px * 2)) !important;\n        }\n        .mobile-close-btn {\n          display: none;\n          @media (max-width: 480px) {\n            display: block;\n          }\n        }\n        .header {\n          display: flex;\n          align-items: center;\n          padding: 1rem;\n          gap: 0.5rem;\n          width: 100%;\n          border-bottom: 3px solid #000;\n          background: var(--colors-primary);\n          color: var(--colors-text-color);\n\n          .logo {\n            width: 48px;\n            aspect-ratio: 1;\n\n            display: grid;\n            place-items: center;\n\n            & img {\n              filter: drop-shadow(0 0 1px black);\n            }\n          }\n\n          .actions {\n            margin-left: auto;\n            display: flex;\n            gap: 1rem;\n\n            button {\n              color: inherit;\n\n              &:hover { scale: 1.2 }\n            }\n          }\n        }\n\n        footer {\n          position: absolute;\n          z-index: 9999;\n          background-color: white;\n          width: 100%;\n          bottom: 0;\n\n          border: 1px solid var(--colors-border-color);\n          border-radius: 10px 10px 0 0;\n          padding: 10px;\n        }\n        footer[disabled],\n        footer[disabled] * {\n          pointer-events: none;\n          opacity: 0.5;\n        }\n\n        .feedback-popup {\n          position: absolute;\n          inset: 0;\n          background: rgba(255, 255, 255, 0.4);\n          backdrop-filter: blur(2px);\n          display: none;\n          z-index: 1;\n          place-items: center;\n        }\n        .feedback-popup.show {\n          display: grid;\n        }\n        .role-container {\n          margin-top: 12px;\n          display: flex;\n          gap: 12px;\n        }\n        button.role-btn {\n          padding: 6px 8px;\n          border: 1px solid var(--colors-border-color);\n          background: white;\n          font-size: 14px;\n          border-radius: 6px;\n          transition: all 250ms ease;\n\n          &:hover {\n            box-shadow: 0 2px 0 #000;\n            transform: translateY(-2px);\n          }\n          &:active {\n            box-shadow: 0 0px 0px #000;\n            transform: translateY(0px);\n          }\n        }\n        chat-message.feedback-positive {\n          border: 1px solid var(--colors-success);\n        }\n\n        chat-message.feedback-negative {\n          border: 1px solid var(--colors-error);\n        }\n      </style>\n      <header class="header">\n        <div class="logo">\n          <img src="${this.state.config.logo_url}" alt="" />\n        </div>\n        <div class="text">\n          <h3\n            class="title"\n            id="title">\n            ${this.state.config.text.title}\n          </h3>\n          <p\n            class="sub-title"\n            id="sub-title">\n            ${this.state.config.text.subtitle}\n          </p>\n        </div>\n        <div class="actions">\n          <button\n            id="maximize"\n            class="maximize"\n            title="Maximize">\n            <svg\n              xmlns="http://www.w3.org/2000/svg"\n              width="24"\n              height="24"\n              viewBox="0 0 24 24"\n              fill="none"\n              stroke="currentColor"\n              stroke-width="2"\n              stroke-linecap="round"\n              stroke-linejoin="round"\n              class="lucide lucide-maximize">\n              <path d="M8 3H5a2 2 0 0 0-2 2v3" />\n              <path d="M21 8V5a2 2 0 0 0-2-2h-3" />\n              <path d="M3 16v3a2 2 0 0 0 2 2h3" />\n              <path d="M16 21h3a2 2 0 0 0 2-2v-3" />\n            </svg>\n          </button>\n          <button\n            id="new-chat-button"\n            title="Start new chat">\n            <svg\n              xmlns="http://www.w3.org/2000/svg"\n              width="24"\n              height="24"\n              viewBox="0 0 24 24"\n              fill="none"\n              stroke="currentColor"\n              stroke-width="2"\n              stroke-linecap="round"\n              stroke-linejoin="round"\n              class="lucide lucide-square-plus">\n              <rect\n                width="18"\n                height="18"\n                x="3"\n                y="3"\n                rx="2" />\n              <path d="M8 12h8" />\n              <path d="M12 8v8" />\n            </svg>\n          </button>\n          <button id="mobile-close-btn" class="mobile-close-btn">\n            <svg \n              xmlns="http://www.w3.org/2000/svg" \n              width="24"\n              height="24"\n              viewBox="0 0 24 24"\n              fill="none"\n              stroke="currentColor"\n              stroke-width="2"\n              stroke-linecap="round"\n              stroke-linejoin="round"\n              class="lucide lucide-x">\n              <path d="M18 6 6 18"/><path d="m6 6 12 12"/>\n            </svg>\n          </button>\n        </div>\n      </header>\n\n      <section class="body" id="body"></section>\n\n      <footer>\n        <message-input></message-input>\n      </footer>\n    `)}}).define("chat-window");(class extends e{static events=["open-file-upload"];initState(){return{config:i.config,files:[],contactType:"email"}}handleEvent(t,e){"open-file-upload"===t&&(this.style.display="grid",this.state.config.animations&&(this.animate({opacity:[0,1],filter:["blur(10px)","blur(0px)"]},{duration:250,easing:"ease-in-out"}),this.$("#input-container").animate({scale:[.5,1],opacity:[0,1]},{duration:250,easing:"ease-in-out"})))}setupListeners(){this.listen(this,"click",this.handleClose.bind(this)),this.listen(this.$("input[type='file'"),"change",this.handleFiles.bind(this)),this.listen(this.$("#send-btn"),"click",this.handleSendFiles.bind(this)),this.listen(this.$("#close-btn"),"click",this.handleClose.bind(this)),this.listen(this.$(".contact input"),"input",this.handleContact.bind(this)),this.listen(this.$("select"),"change",this.handleContactChange.bind(this))}handleContact(t){console.log(t)}handleContactChange(t){const e=t.target.value;this.setState({contactType:e});const n=this.$(".contact input");n.type=e,n.placeholder="email"===e?"your@email.com":"+1234567890"}handleClose(t){if(t.composedPath()[0]===this||t.composedPath()[0]===this.$("#close-btn"))if(this.state.config.animations){const t=this.animate({opacity:[1,0],filter:["blur(0px)","blur(10px)"]},{duration:250,easing:"ease-in-out"});this.$("#input-container").animate({scale:[1,.5],opacity:[1,0]},{duration:250,easing:"ease-in-out"}),t.onfinish=()=>this.style.display="none"}else this.style.display="none"}handleFiles(){const t=[...this.state.files,...this.$("input[type='file']").files||[]];this.setState({files:Array.from(t)}),this.filesTemplate()}delete(t){const e=t.dataset.fileName,s=this.state.files.filter((t=>t.name!==e));this.setState({files:s}),this._render(),n.triggerEvent("file-delete",{files:this.state.files})}handleDelete(e){const n=e.dataset.filename,s=this.state.files.filter((t=>t.name!==n));this.setState({files:s}),this.filesTemplate(),0===this.state.files.length&&(this.$("#files-wrapper").innerHTML=t`<label for="files"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-upload-icon lucide-upload"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" x2="12" y1="3" y2="15"/></svg> <span>Select Files</span> <input type="file" id="files" multiple="multiple" hidden accept="${this.formatAcceptString(this.state.config.files.supported)}"></label>`),this.listen(this.$("input[type='file'"),"change",this.handleFiles.bind(this))}handleSendFiles(){console.log(this.state.files)}formatFileSize(t){return t<1024?t+" bytes":t<1048576?(t/1024).toFixed(1)+" KB":(t/1048576).toFixed(1)+" MB"}formatAcceptString(t){return t.map((t=>`.${t}`)).join(", ")}filesTemplate(){this.$("#files-wrapper").innerHTML=t`${this.state.files.length>0?`<div class="files">\n        ${this.state.files.map((t=>`<div class="file">\n          <svg\n            xmlns="http://www.w3.org/2000/svg"\n            width="12"\n            height="12"\n            viewBox="0 0 24 24"\n            fill="none"\n            stroke="currentColor"\n            stroke-width="2" \n            stroke-linecap="round"\n            stroke-linejoin="round">\n            <path d="M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"/>\n            <path d="M14 2v4a2 2 0 0 0 2 2h4"/>\n          </svg>\n          <p title="${t.name}">${t.name}</p><span>${this.formatFileSize(t.size)}</span>\n          <button id="file-delete-btn" data-fileName="${t.name}">\n            <svg \n              xmlns="http://www.w3.org/2000/svg"\n              width="12"\n              height="12"\n              viewBox="0 0 24 24"\n              fill="none"\n              stroke="currentColor"\n              stroke-width="2"\n              stroke-linecap="round"\n              stroke-linejoin="round">\n              <path d="M18 6 6 18"/><path d="m6 6 12 12"/>\n            </svg>\n          </button>\n        </div>`)).join("")}\n\n        <label for="files" style="margin-left: auto; position: static; transform: unset;">\n          <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-plus-icon lucide-plus"><path d="M5 12h14"/><path d="M12 5v14"/></svg>\n          <span>Add more</span>\n          <input type="file" id="files" multiple hidden accept="${this.formatAcceptString(this.state.config.files.supported)}"/>\n        </label>\n      </div>`:""}`,this.$$("#file-delete-btn").forEach((t=>this.listen(t,"click",(()=>this.handleDelete(t))))),this.listen(this.$("input[type='file'"),"change",this.handleFiles.bind(this))}template(){return t`<style>:host{display:none;position:fixed;z-index:99999999999;background:rgba(0,0,0,.3);inset:0;place-items:center;backdrop-filter:blur(3px)}.input-container{display:flex;flex-direction:column;background:#fff;padding:10px;width:450px;aspect-ratio:1;border:1px solid var(--colors-border-color);border-radius:12px;gap:10px}@media (max-width:480px){.input-container{max-width:320px;aspect-ratio:unset;height:475px}}.input-container section{display:flex;flex-direction:column;flex:1;overflow-y:auto}#files-wrapper{position:relative;flex:1;overflow-y:auto;padding:5px;border-radius:10px;border:1px solid var(--colors-border-color)}#files-wrapper label{padding:8px 10px;border:1px solid var(--colors-border-color);border-radius:6px;display:flex;gap:10px;cursor:pointer;font-size:12px;align-items:center;transition:all 250ms ease;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}label:hover{background-color:#ddd}.files{display:flex;flex-direction:column;gap:6px}.file{padding:5px 10px;border:1px solid var(--colors-border-color);border-radius:6px;display:flex;align-items:center;gap:10px;font-size:12px;transition:all 250ms ease}.file:hover{background-color:#ddd}.file button{padding:5px;background-color:var(--colors-error);border-radius:4px;opacity:0;transition:all 250ms ease;color:#fff}.file:hover button{opacity:1}.file p{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:200px}.file span{margin-left:auto;color:#959595}footer{margin-top:auto;display:flex;justify-content:end;gap:10px;align-items:center}footer button{padding:4px 8px;border:1px solid var(--colors-border-color);font-size:14px;border-radius:6px;transition:all 250ms ease}footer button:disabled{opacity:.5;cursor:not-allowed}.send-btn{background-color:var(--colors-primary);color:var(--colors-text-color)}.send-btn:hover{background-color:var(--colors-primary-hover)}.close-btn:hover{background-color:#ddd}select{-webkit-appearance:none;appearance:none;padding:10px;min-width:80px;border:none;background-color:#eee;cursor:pointer;transition:all 250ms ease;outline:0;font-size:12px}select:hover{background-color:#ccc}select{background-image:url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGNsYXNzPSJsdWNpZGUgbHVjaWRlLWNoZXZyb24tZG93bi1pY29uIGx1Y2lkZS1jaGV2cm9uLWRvd24iPjxwYXRoIGQ9Im02IDkgNiA2IDYtNiIvPjwvc3ZnPg==");background-size:16px;background-repeat:no-repeat;background-position:calc(100% - 10px) center}.select-wrapper{display:flex;align-items:center;border:1px solid var(--colors-border-color);border-radius:10px;outline:0;background-color:#fff;overflow:hidden}.select-wrapper input{align-self:stretch;font-size:12px;padding:0 10px;width:100%;outline:0;background-color:transparent;border:none;border-left:1px solid #ddd}.info{display:flex;gap:10px;padding:10px;border-radius:10px;border:1px solid var(--colors-border-color);margin:16px 0 20px}.info p{line-height:1}</style><div class="input-container" id="input-container"><header><h2>Upload Files</h2><div class="info"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-circle-alert-icon lucide-circle-alert"><circle cx="12" cy="12" r="10"/><line x1="12" x2="12" y1="8" y2="12"/><line x1="12" x2="12.01" y1="16" y2="16"/></svg><p>Supported files: ${this.state.config.files.supported.map((t=>`${t.toUpperCase()}`)).join(", ")}</p></div><div class="contact"><h4>Contact Information</h4><div class="select-wrapper"><select><option value="email" selected="selected">Email</option><option value="phone">Phone</option></select> <input type="email" placeholder="your@email.com"></div></div></header><section><h4>Files</h4><div id="files-wrapper"><label for="files"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-upload-icon lucide-upload"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" x2="12" y1="3" y2="15"/></svg> <span>Select Files</span> <input type="file" id="files" multiple="multiple" hidden accept="${this.formatAcceptString(this.state.config.files.supported)}"></label></div></section><footer><button class="close-btn" id="close-btn">Close</button> <button class="send-btn" id="send-btn" disabled="disabled">Send Files</button></footer></div>`}}).define("file-upload");(class extends e{static events=["window-state"];initState(){const t=getComputedStyle(document.documentElement);return{config:i.config,fontFamily:"",documentOverflow:t.overflow}}connectedCallback(){super.connectedCallback(),this.setAttribute("position",this.state.config.position)}handleEvent(t,e){"window-state"===t&&(this.$("chat-window").setAttribute("open",e),document.documentElement.style.overflow=e?"hidden":this.state.documentOverflow)}template(){const{colors:e,button:n,window:s}=this.state.config;return t`<style>:host{position:fixed;display:flex;flex-direction:column;--font-family:${this.state.fontFamily};--colors-primary:${e.primary};--colors-primary-hover:${function(t,e,n=!1){let s=parseInt(t.slice(1,3),16),i=parseInt(t.slice(3,5),16),o=parseInt(t.slice(5,7),16);n?(s=Math.min(255,s+(255-s)*e/100),i=Math.min(255,i+(255-i)*e/100),o=Math.min(255,o+(255-o)*e/100)):(s=Math.max(0,s*(100+e)/100),i=Math.max(0,i*(100+e)/100),o=Math.max(0,o*(100+e)/100));return`#${Math.round(s).toString(16).padStart(2,"0")}${Math.round(i).toString(16).padStart(2,"0")}${Math.round(o).toString(16).padStart(2,"0")}`}(e.primary,-20)};--colors-text-color:${e.textColor};--colors-user-message-background:${e.userMessageBackground};--colors-bot-message-background:${e.botMessageBackground};--colors-border-color:${e.borderColor};--colors-error:${e.error};--colors-success:${e.success};--button-width:${n.dimensions.width+"px"};--button-height:${n.dimensions.height+"px"};--window-width:${s.dimensions.width+"px"};--window-height:${s.dimensions.height+"px"}}:host([position=bottom-right]){bottom:20px;right:20px}:host([position=bottom-right]) chat-window{bottom:calc(var(--button-height) + 40px);right:calc(var(--button-width) + 40px)}:host([position=bottom-center]){bottom:20px;left:0;right:0;margin-left:auto!important;margin-right:auto!important;width:fit-content}:host([position=bottom-center]) chat-window{bottom:calc(var(--button-height) + 40px);left:0;right:0;margin-left:auto!important;margin-right:auto!important;box-shadow:0 3px #000}:host([position=bottom-left]){bottom:20px;left:20px}:host([position=bottom-left]) chat-window{bottom:calc(var(--button-height) + 40px);left:calc(var(--button-width) + 40px);box-shadow:-3px 3px #000}</style><chat-window></chat-window><chat-button></chat-button><file-upload></file-upload>`}}).define("luccid-chat-bot"),i.init().then((()=>{const t=document.createElement("link");t.href=i.config.font_url,t.rel="stylesheet",document.head.appendChild(t);const e=i.config.font_url.match(/family=([^:&]+)/),n=e?decodeURIComponent(e[1]).replace(/\+/g," "):"inherit",s=document.createElement("luccid-chat-bot");s.setState({fontFamily:n}),document.body.appendChild(s)})).catch((t=>{console.error("Failed to initialize config:",t)}))}();
//# sourceMappingURL=chat-bot.js.map
